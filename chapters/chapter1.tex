\newcommand{\R}{\mathbb{R}}
\chapter{Preliminares}
\section{Morse theory: A quick review}
\input{chapters/conventions.tex}


Given a manifold we can build a nice function on it, $f$,
so that it's sublevels $M^t=f^{-1}(-\infty,t]$ give us a natural way to 
deduce a CW-structure for the manifold.

In fact, these same function give us in a natural way the Morse-Smale complex,
which allows us to compute the homology of the manifold.

\begin{definition}[Morse function]

Let $M$ be a manifold, and $f\in C^\infty(M,\mathbb{R})$.
We say that $f$ is a morse function if the set of critical points
of $f$ is isolated. 

That is, if:
$
Crit(f)=\{x\in M: df\vert_x=0
\}
$
is isolated.

\end{definition}

We say that a critical point of $f$ has index $k$,
if the hessian of $f$ has index $k$ at the critical point.

We denote the critical points of index $k$ as $Crit_k(f)$.

It is well known that for any given manifold there are plenty of Morse functions,
in particular we have the following:


\begin{theorem}
\cite{mat1997}
Let $g\in C^\infty(M,\mathbb{R})$, and let $\epsilon>0$
then there exists $f\in C^\infty(M,\mathbb{R})$ so that $f$
is a Morse function and $f$ and $g$ are $C^2$-close.
\end{theorem}

So Morse functions are dense in the ring $C^\infty(M,\mathbb{R})$,
and a fortiori, Morse functions always exits.

Morse functions give quite a bit of topological information on the manifold,
specially in the compact case. 



One important source of complexes is the Morse-Smale complex,
which arises in a natural way.


\subsection{Fundamental theorems of Morse theory}

\begin{theorem}[Morse lemma]
\cite{mat1997}
Let $M^n$ be a manifold, and $f$ a Morse function on $M$.
Let $x_0$ be critical point of $f$ of index $k$.


Then there is a neighbourhood $V$ of $x_0$ and a chart 
$y:U\to V\subset M$. so that:

$$
f\circ y (y_1,\ldots,y_n)
=
-y_1^2
-\cdots
-y_k^2
+y_{k+1}^2
+\cdots
+y_n^2
+C
$$

Where $C$ is a constant.
\end{theorem}

Let $f$ be a Morse function on $M$,
We notice that in the compact case $f$ has 
a minimum, $m$ and a maximum $M$
achieved at points $x_m$ and $x_M$.

Then $M^{x_m}=\emptyset$ and $M^{x_M}=M$.
This hints that we can restruct $M$ from how the sets $M^t$
change as $t$ moves through the real line.

In particular, fix some $\varepsilon$ which will be assumed to be
as small as needed, we wonder if there is any relation between $M^t$
and $M^{t+\varepsilon}$. It turns out, as Morse \cite{mor1934} showed
we have that if $f$ does not have any critical point in the interval 
$(t,t+\varepsilon)$ then
 $M^t$ and $M^{t+\varepsilon}$ are difeomorphic. The proof is
 in fact quite elementary.
 
 A more subtle thing Morse proved is what happens when $M^t$
 crosses over a critical point. In this cased he showed that,
 if choose $\varepsilon$ so that $\text{Crit}(f)\cap (t,t+\varepsilon)$
 has exactly one point (which we can always do by hypothesis)
 then
  $M^{t+\varepsilon}$ can be obtained by adjoining a $k$-cell to $M^t$
 where $k$ happens to be the index of the unique critical point in 
$(t,t+\varepsilon)$.


In summary

\begin{theorem}
\cite{mor1934}
Let $\varepsilon>0$ so that
$$\text{Crit}(f)\cap (t,t+\varepsilon)=\emptyset$$

Then   $M^{t}$ and $M^{t+\varepsilon}$ 
are difeomorphic.


\end{theorem}

\begin{theorem}
\cite{mor1934}
Let $\varepsilon>0$ so that
$$\text{Crit}(f)\cap (t,t+\varepsilon)=\{x_0\}$$

Let $k$ be the index of $x_0$. Then

Then  $M^{t+\varepsilon}$ 
is homotopy equivalent to $M^t\cup_\phi (D^{n-k}\times D^k)$ where
$D^k$ is the $k$-disk and $\phi$ is and adjunction map.
%between $\partial (D^{n-k}\times D^k)$ and $\partial M^t$.


\end{theorem}

\begin{example}
One classical example of the above theorems is how to use
a Morse function to obtain the decomposition of the Torus:
\end{example}

\begin{corollary}
\cite{sma1961}
Any compact manifold 
of dimension $n$
is homotopy equivalent to a space such as the following:

$$
D^n\cup
D^{n-k_1}\times D^{k_1}
\cup
\cdots
\cup
D^{n-k_m}\times D^{k_m}
$$
\end{corollary}


\begin{theorem}[Morse inequalities]
\label{morseineq}
Let $M^n$ be a compact manifold, and $b_i$ it's betti numbers.
Let $f$ be a Morse function on $M$. And let $\lambda_k$ be the 
number of $k$-index critical points of $f$. Then we have that the 
so called weak Morse inequality holds:

$$
\lambda_i\geq b_i,\quad
\forall i\in\mathbb{N}
$$

As well as the so called strong Morse inequality:

$$
\sum_{i=0}^{j}(-1)^i\lambda_i
\geq 
\sum_{i=0}^{j}(-1)^ib_i,\quad
0\leq j\leq n
$$

In the particular where $i=n(=dim(M))$ we have equality:

$$
\mathcal{X}(M)=
\sum_{i=0}^{n}(-1)^i\lambda_i
=
\sum_{i=0}^{n}(-1)^ib_i
$$

Where $\mathcal{X}(M)$ is the Euler-Poincaré characteristic.

\end{theorem}

\subsection{An application of Morse theory}

In this subsection we describe how to use Morse theory to classify closed $1$-manifolds.
In particular, we show the well-know theorem:

\begin{theorem}
A closed connected $1$-manifold is diffeomorphic to $\mathbb{S}^1$.
\end{theorem}

We briefly mention that it can be used to derive the usual classification of $2$-manifolds.





\subsection{The Morse-Smale complex}

\begin{definition}[Differential complex]
We say that a collection of indexed abelian groups
$\{C_i\}_{i=0}^{\infty}$ is a differential complex if
it has a linear operator:
$\delta_i: C_{i+1}\to C_i$
so that $\delta_i\circ\delta_{i+1}=0$.

Usually, we shall consider $\delta: C\to C$ where $C=\oplus C_i$
and $\delta$ is defined as the unique linear operator 
that verifies: $\delta\vert_{C_i}=\delta_i$.

And so, we may write that $\{C_i\}_{i=0}^{\infty}$ 
is a differential complex if and only if $\delta^2=0$.

Finally, given $C$ and $D$ two differential compexes,
then we say that $f:C\to D$
is a chain map if $f\circ\delta_C=\delta_D\circ f$.

\end{definition}


Morse functions give a natural complex which computes the homology
of the manifold.

We define the chain groups 
to be:

$$
C_k(f)
\defequal
\left\{
\sum
_
{c\in \text{Crit}_{k}(f)}
a c
%\vert
:
a\in \mathbb{Z}_2
\right\}
$$

And we define the differential operator $\partial$ to be:

$$
\partial a
=
\sum
_{b\in \text{Crit}_{k-1}(f)}
n(a,b)b
$$

Where $n(a,b)$ is the number of trajectories flowing from $a$
to $b$ through the gradient flow. This number is finite, and
we have that $\partial^2=0$.

\subsection{Discrete Morse Theory}

We can consider Morse theory on simplicial complexes or simplicial sets,
 in this case,
instead of having critical points we have critical faces instead of critical points.

This idea is as was previously, we consider the growing sets $f^{-1}(\infty,t]$
and we observe for which values of $t$ the type of homotopy changes.

\begin{definition}[Discrete Morse functions]

Let $\mathcal{K}$ be a simplicial complex.

Then we denote $\alpha_i^{(p)}\in\mathcal{K}$ a $p$-dimensional face of
$\mathcal{K}$ and we denote $\beta<\alpha$ is $\beta$ is subface of $\alpha$.

Then we say that $f:\mathcal{K}\to\mathbb{R}$ is that a discrete Morse function
if and only if $f$ assigns higher values to higher dimensional simplices with few exceptions. Formally, if $f$ satifies both of the following definitions:

$$
\begin{cases}
\#\{
\beta^{(p+1)}>\alpha\vert
f(\beta)\leq f(\alpha)
\}&\leq 1
\\
\#\{
\gamma^{(p-1)}<\alpha\vert
f(\gamma)\geq f(\alpha)
\}
&
\leq 1
\end{cases}
$$


Finally, we say that $\alpha^{(p)}\in\mathcal{K}$ is a critical simplex if and only if:

$$
\begin{cases}
\#\{
\beta^{(p+1)}>\alpha\vert
f(\beta)\leq f(\alpha)
\}&=0
\\
\#\{
\gamma^{(p-1)}<\alpha\vert
f(\gamma)\geq f(\alpha)
\}
&
=0
\end{cases}
$$

\end{definition}

In general, we will have that always one of the above sets will be empty, that is:

\begin{lemma}
Let $\mathcal{K}$ be a simplicial complex, and let
$\alpha^{(p)}\in\mathcal{K}$ be a non-critical compolex, then either
$$
\#\{
\beta^{(p+1)}>\alpha\vert
f(\beta)\leq f(\alpha)
\}=0
$$
or 
$$
\#\{
\gamma^{(p-1)}<\alpha\vert
f(\gamma)\geq f(\alpha)
\}
=0
$$

\end{lemma}

And we have a similar result as in the smooth case,
that is the discrete Morse function describes the homotopy type of the complex:

\begin{theorem}
Let $\mathcal{K}$ be a simplicial complex and $f$ a discrete Morse function on it.
Then $\mathcal{K}$ is homotopy equivalent to another simplicial complex which has exactly one complex for every critical complex of $\mathcal{K}$.
\end{theorem}

Another important similarity with the smooth case is that the standart Morse inequalities hold:

\begin{theorem}[Morse inequalities]
Let $\mathcal{K}$ be a simplicial complex, and $b_i$ it's betti numbers.
Let $f$ be a Morse function on $M$. And let $\lambda_k$ be the 
number of $k$-dimensional critical simplices. 
Then everything holds exactly as in theorem \ref{morseineq}.

In particular, all of the following holds:

$$
\lambda_i\geq b_i,\quad
\forall i\in\mathbb{N}
$$

$$
\sum_{i=0}^{j}(-1)^i\lambda_i
\geq 
\sum_{i=0}^{j}(-1)^ib_i,\quad
0\leq j\leq n
$$

$$
\mathcal{X}(M)=
\sum_{i=0}^{n}(-1)^i\lambda_i
=
\sum_{i=0}^{n}(-1)^ib_i
$$

Where in this case n is the dimension of $\mathcal{K}$,
which is the maximum dimension of the simplices of $\mathcal{K}$.
\end{theorem}

{\color{red} Add handle decomposition theorem}
\begin{theorem}[Handle decomposition]
\label{handle}
\end{theorem}



\subsection{Stability of Morse-Smale complexes}

\section{Kernel estimators and density functions}


\subsection{Kernel regresssion}
\begin{definition}[Kernel functino]
    \label{skernel}
    Let $X$ be a probability space, then we say that $K:X\to [0,\infty)$
    is a density function if:
    \begin{enumerate}
        \item $K$ is integrable.
        \item $\int_\mathbb{R} K = 1$.
        \item $K(x)=K(-x), \forall x\in\mathbb{R}$.
    \end{enumerate}


It's common to refer to the maxima of kernel regression as their modes.
\end{definition}

There are several commonly used kernel functions, we list some of them below:
\begin{example}
\end{example}
    \begin{center}
    \begin{tabular}{|c | c|}
        \hline
        Name & $K(x)$\\\hline
        \hline
        Epanechnikov & $\frac{3}{4}(1-x^2)1_{[-1,1]}$\\\hline
        Gaussian & $\frac{1}{\sqrt{2}} e^{-\frac{1}{2} x^2}$\\\hline
        Sigmoid & $\frac{2}{\pi}\frac{1}{e^x-e^{-x}}$\\\hline
    \end{tabular}
    \end{center}


\section{Haussdorf distance}
\label{haussdorf}

In the future we will use the Haussdorf distance to compare how different two subsets of $\mathbb{R}^n$ are:

\begin{definition}[Haussdorf distance]
    Let $A$,$B$ be subsets of $\mathbb{R}^n$. Then the Haussdorf distance between $A$ and $B$,
    denoted as $Hauss(A,B)$ and is defined as:
    $$
        Hauss(A,B)
        =
        \inf\{r>0:
            A\oplus r\subset B
            \text{ or }
            B\oplus r\subset A
        \}
    $$
\end{definition}

\section{Brief review of statistical tests}

